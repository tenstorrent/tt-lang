/Users/zcarver/Developer/tt-mlir/lib/Dialect/D2M/Transforms/InsertDstRegisterAccess.cpp:209: static AcquireDstOp mlir::tt::d2m::(anonymous namespace)::D2MInsertDstRegisterAccessRewriter::insertAcquireDst(PatternRewriter &, Location, Region &, const CopyInfoMap &, Operation *, unsigned int): Assertion `maxDstSliceIdx < numDstSlices` failed, was `4 < 4`, Insufficient DST capacity for all operands.
PLEASE submit a bug report to https://github.com/llvm/llvm-project/issues/ and include the crash backtrace and instructions to reproduce the bug.
Stack dump:
0.	Program arguments: 
1.	Running pass 'D2MInsertDstRegisterAccess' on operation 'builtin.module'
 #0 0x0000000336320c2c llvm::sys::PrintStackTrace(llvm::raw_ostream&, int) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/libTTMLIRPythonCAPI.dylib+0xd0c2c)
 #1 0x00000003363214e8 SignalHandler(int, __siginfo*, void*) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/libTTMLIRPythonCAPI.dylib+0xd14e8)
 #2 0x000000019b21d6a4 (/usr/lib/system/libsystem_platform.dylib+0x1804ad6a4)
 #3 0x000000019b1e3848 (/usr/lib/system/libsystem_pthread.dylib+0x180473848)
 #4 0x000000019b0ec9e4 (/usr/lib/system/libsystem_c.dylib+0x18037c9e4)
 #5 0x0000000351284a40 mlir::tt::d2m::(anonymous namespace)::D2MInsertDstRegisterAccessRewriter::insertAcquireDst(mlir::PatternRewriter&, mlir::Location, mlir::Region&, llvm::DenseMap<mlir::Operation*, mlir::tt::d2m::(anonymous namespace)::D2MInsertDstRegisterAccessRewriter::CopyInfo, llvm::DenseMapInfo<mlir::Operation*, void>, llvm::detail::DenseMapPair<mlir::Operation*, mlir::tt::d2m::(anonymous namespace)::D2MInsertDstRegisterAccessRewriter::CopyInfo>> const&, mlir::Operation*, unsigned int) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/_ttmlir.cpython-311-darwin.so+0x3e8a40)
 #6 0x0000000351283258 mlir::tt::d2m::(anonymous namespace)::D2MInsertDstRegisterAccessRewriter::insertDstRegisterAccess(mlir::PatternRewriter&, mlir::tt::d2m::GenericOp, mlir::Region&, unsigned int, mlir::Operation*) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/_ttmlir.cpython-311-darwin.so+0x3e7258)
 #7 0x0000000351282a7c mlir::tt::d2m::(anonymous namespace)::D2MInsertDstRegisterAccessRewriter::matchAndRewrite(mlir::tt::d2m::GenericOp, mlir::PatternRewriter&) const::'lambda'(mlir::linalg::GenericOp)::operator()(mlir::linalg::GenericOp) const (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/_ttmlir.cpython-311-darwin.so+0x3e6a7c)
 #8 0x00000003512827b8 std::__1::enable_if<!llvm::is_one_of<mlir::linalg::GenericOp, mlir::Operation*, mlir::Region*, mlir::Block*>::value && std::is_same<void, void>::value, void>::type mlir::detail::walk<(mlir::WalkOrder)1, mlir::ForwardIterator, mlir::tt::d2m::(anonymous namespace)::D2MInsertDstRegisterAccessRewriter::matchAndRewrite(mlir::tt::d2m::GenericOp, mlir::PatternRewriter&) const::'lambda'(mlir::linalg::GenericOp)&, mlir::linalg::GenericOp, void>(mlir::Operation*, mlir::tt::d2m::(anonymous namespace)::D2MInsertDstRegisterAccessRewriter::matchAndRewrite(mlir::tt::d2m::GenericOp, mlir::PatternRewriter&) const::'lambda'(mlir::linalg::GenericOp)&)::'lambda'(mlir::Operation*)::operator()(mlir::Operation*) const (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/_ttmlir.cpython-311-darwin.so+0x3e67b8)
 #9 0x0000000351282758 void llvm::function_ref<void (mlir::Operation*)>::callback_fn<std::__1::enable_if<!llvm::is_one_of<mlir::linalg::GenericOp, mlir::Operation*, mlir::Region*, mlir::Block*>::value && std::is_same<void, void>::value, void>::type mlir::detail::walk<(mlir::WalkOrder)1, mlir::ForwardIterator, mlir::tt::d2m::(anonymous namespace)::D2MInsertDstRegisterAccessRewriter::matchAndRewrite(mlir::tt::d2m::GenericOp, mlir::PatternRewriter&) const::'lambda'(mlir::linalg::GenericOp)&, mlir::linalg::GenericOp, void>(mlir::Operation*, mlir::tt::d2m::(anonymous namespace)::D2MInsertDstRegisterAccessRewriter::matchAndRewrite(mlir::tt::d2m::GenericOp, mlir::PatternRewriter&) const::'lambda'(mlir::linalg::GenericOp)&)::'lambda'(mlir::Operation*)>(long, mlir::Operation*) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/_ttmlir.cpython-311-darwin.so+0x3e6758)
#10 0x0000000336858adc llvm::function_ref<void (mlir::Operation*)>::operator()(mlir::Operation*) const (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/libTTMLIRPythonCAPI.dylib+0x608adc)
#11 0x0000000336858a3c void mlir::detail::walk<mlir::ForwardIterator>(mlir::Operation*, llvm::function_ref<void (mlir::Operation*)>, mlir::WalkOrder) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/libTTMLIRPythonCAPI.dylib+0x608a3c)
#12 0x00000003368589ec void mlir::detail::walk<mlir::ForwardIterator>(mlir::Operation*, llvm::function_ref<void (mlir::Operation*)>, mlir::WalkOrder) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/libTTMLIRPythonCAPI.dylib+0x6089ec)
#13 0x00000003368589ec void mlir::detail::walk<mlir::ForwardIterator>(mlir::Operation*, llvm::function_ref<void (mlir::Operation*)>, mlir::WalkOrder) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/libTTMLIRPythonCAPI.dylib+0x6089ec)
#14 0x00000003512826b4 std::__1::enable_if<!llvm::is_one_of<mlir::linalg::GenericOp, mlir::Operation*, mlir::Region*, mlir::Block*>::value && std::is_same<void, void>::value, void>::type mlir::detail::walk<(mlir::WalkOrder)1, mlir::ForwardIterator, mlir::tt::d2m::(anonymous namespace)::D2MInsertDstRegisterAccessRewriter::matchAndRewrite(mlir::tt::d2m::GenericOp, mlir::PatternRewriter&) const::'lambda'(mlir::linalg::GenericOp)&, mlir::linalg::GenericOp, void>(mlir::Operation*, mlir::tt::d2m::(anonymous namespace)::D2MInsertDstRegisterAccessRewriter::matchAndRewrite(mlir::tt::d2m::GenericOp, mlir::PatternRewriter&) const::'lambda'(mlir::linalg::GenericOp)&) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/_ttmlir.cpython-311-darwin.so+0x3e66b4)
#15 0x000000035128262c void mlir::Block::walk<(mlir::WalkOrder)1, mlir::ForwardIterator, mlir::tt::d2m::(anonymous namespace)::D2MInsertDstRegisterAccessRewriter::matchAndRewrite(mlir::tt::d2m::GenericOp, mlir::PatternRewriter&) const::'lambda'(mlir::linalg::GenericOp), void>(llvm::ilist_iterator<llvm::ilist_detail::node_options<mlir::Operation, true, false, void, false, void>, false, false>, llvm::ilist_iterator<llvm::ilist_detail::node_options<mlir::Operation, true, false, void, false, void>, false, false>, mlir::tt::d2m::(anonymous namespace)::D2MInsertDstRegisterAccessRewriter::matchAndRewrite(mlir::tt::d2m::GenericOp, mlir::PatternRewriter&) const::'lambda'(mlir::linalg::GenericOp)&&) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/_ttmlir.cpython-311-darwin.so+0x3e662c)
#16 0x0000000351282544 void mlir::Block::walk<(mlir::WalkOrder)1, mlir::ForwardIterator, mlir::tt::d2m::(anonymous namespace)::D2MInsertDstRegisterAccessRewriter::matchAndRewrite(mlir::tt::d2m::GenericOp, mlir::PatternRewriter&) const::'lambda'(mlir::linalg::GenericOp), mlir::linalg::GenericOp, void>(mlir::tt::d2m::(anonymous namespace)::D2MInsertDstRegisterAccessRewriter::matchAndRewrite(mlir::tt::d2m::GenericOp, mlir::PatternRewriter&) const::'lambda'(mlir::linalg::GenericOp)&&) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/_ttmlir.cpython-311-darwin.so+0x3e6544)
#17 0x0000000351282474 mlir::tt::d2m::(anonymous namespace)::D2MInsertDstRegisterAccessRewriter::matchAndRewrite(mlir::tt::d2m::GenericOp, mlir::PatternRewriter&) const (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/_ttmlir.cpython-311-darwin.so+0x3e6474)
#18 0x000000035123a2bc mlir::detail::OpOrInterfaceRewritePatternBase<mlir::tt::d2m::GenericOp>::matchAndRewrite(mlir::Operation*, mlir::PatternRewriter&) const (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/_ttmlir.cpython-311-darwin.so+0x39e2bc)
#19 0x0000000337b2de60 void llvm::function_ref<void ()>::callback_fn<mlir::PatternApplicator::matchAndRewrite(mlir::Operation*, mlir::PatternRewriter&, llvm::function_ref<bool (mlir::Pattern const&)>, llvm::function_ref<void (mlir::Pattern const&)>, llvm::function_ref<llvm::LogicalResult (mlir::Pattern const&)>)::$_0>(long) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/libTTMLIRPythonCAPI.dylib+0x18dde60)
#20 0x0000000337b2b6f4 mlir::PatternApplicator::matchAndRewrite(mlir::Operation*, mlir::PatternRewriter&, llvm::function_ref<bool (mlir::Pattern const&)>, llvm::function_ref<void (mlir::Pattern const&)>, llvm::function_ref<llvm::LogicalResult (mlir::Pattern const&)>) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/libTTMLIRPythonCAPI.dylib+0x18db6f4)
#21 0x000000033672bec8 (anonymous namespace)::GreedyPatternRewriteDriver::processWorklist() (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/libTTMLIRPythonCAPI.dylib+0x4dbec8)
#22 0x000000033672b6a4 void llvm::function_ref<void ()>::callback_fn<(anonymous namespace)::RegionPatternRewriteDriver::simplify(bool*) &&::$_2>(long) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/libTTMLIRPythonCAPI.dylib+0x4db6a4)
#23 0x000000033672959c mlir::applyPatternsGreedily(mlir::Region&, mlir::FrozenRewritePatternSet const&, mlir::GreedyRewriteConfig, bool*) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/libTTMLIRPythonCAPI.dylib+0x4d959c)
#24 0x00000003510f5f10 mlir::applyPatternsGreedily(mlir::Operation*, mlir::FrozenRewritePatternSet const&, mlir::GreedyRewriteConfig, bool*) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/_ttmlir.cpython-311-darwin.so+0x259f10)
#25 0x0000000351281b08 mlir::tt::d2m::(anonymous namespace)::D2MInsertDstRegisterAccess::runOnOperation() (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/_ttmlir.cpython-311-darwin.so+0x3e5b08)
#26 0x00000003364302dc void llvm::function_ref<void ()>::callback_fn<mlir::detail::OpToOpPassAdaptor::run(mlir::Pass*, mlir::Operation*, mlir::AnalysisManager, bool, unsigned int)::$_3>(long) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/libTTMLIRPythonCAPI.dylib+0x1e02dc)
#27 0x000000033642a80c mlir::detail::OpToOpPassAdaptor::run(mlir::Pass*, mlir::Operation*, mlir::AnalysisManager, bool, unsigned int) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/libTTMLIRPythonCAPI.dylib+0x1da80c)
#28 0x000000033642ae54 mlir::detail::OpToOpPassAdaptor::runPipeline(mlir::OpPassManager&, mlir::Operation*, mlir::AnalysisManager, bool, unsigned int, mlir::PassInstrumentor*, mlir::PassInstrumentation::PipelineParentInfo const*) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/libTTMLIRPythonCAPI.dylib+0x1dae54)
#29 0x000000033642c478 mlir::detail::OpToOpPassAdaptor::runOnOperationAsyncImpl(bool) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/libTTMLIRPythonCAPI.dylib+0x1dc478)
#30 0x00000003364302c4 void llvm::function_ref<void ()>::callback_fn<mlir::detail::OpToOpPassAdaptor::run(mlir::Pass*, mlir::Operation*, mlir::AnalysisManager, bool, unsigned int)::$_3>(long) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/libTTMLIRPythonCAPI.dylib+0x1e02c4)
#31 0x000000033642a80c mlir::detail::OpToOpPassAdaptor::run(mlir::Pass*, mlir::Operation*, mlir::AnalysisManager, bool, unsigned int) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/libTTMLIRPythonCAPI.dylib+0x1da80c)
#32 0x000000033642ae54 mlir::detail::OpToOpPassAdaptor::runPipeline(mlir::OpPassManager&, mlir::Operation*, mlir::AnalysisManager, bool, unsigned int, mlir::PassInstrumentor*, mlir::PassInstrumentation::PipelineParentInfo const*) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/libTTMLIRPythonCAPI.dylib+0x1dae54)
#33 0x000000033642c478 mlir::detail::OpToOpPassAdaptor::runOnOperationAsyncImpl(bool) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/libTTMLIRPythonCAPI.dylib+0x1dc478)
#34 0x00000003364302c4 void llvm::function_ref<void ()>::callback_fn<mlir::detail::OpToOpPassAdaptor::run(mlir::Pass*, mlir::Operation*, mlir::AnalysisManager, bool, unsigned int)::$_3>(long) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/libTTMLIRPythonCAPI.dylib+0x1e02c4)
#35 0x000000033642a80c mlir::detail::OpToOpPassAdaptor::run(mlir::Pass*, mlir::Operation*, mlir::AnalysisManager, bool, unsigned int) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/libTTMLIRPythonCAPI.dylib+0x1da80c)
#36 0x000000033642ae54 mlir::detail::OpToOpPassAdaptor::runPipeline(mlir::OpPassManager&, mlir::Operation*, mlir::AnalysisManager, bool, unsigned int, mlir::PassInstrumentor*, mlir::PassInstrumentation::PipelineParentInfo const*) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/libTTMLIRPythonCAPI.dylib+0x1dae54)
#37 0x000000033642e5a0 mlir::PassManager::runPasses(mlir::Operation*, mlir::AnalysisManager) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/libTTMLIRPythonCAPI.dylib+0x1de5a0)
#38 0x000000033642e218 mlir::PassManager::run(mlir::Operation*) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/libTTMLIRPythonCAPI.dylib+0x1de218)
#39 0x000000033626222c mlirPassManagerRunOnOp (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/libTTMLIRPythonCAPI.dylib+0x1222c)
#40 0x0000000119f17974 mlir::python::populatePassManagerSubmodule(nanobind::module_&)::$_8::operator()((anonymous namespace)::PyPassManager&, mlir::python::PyOperationBase&) const (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/_mlir.cpython-311-darwin.so+0x2db974)
#41 0x0000000119f17884 _object* nanobind::detail::func_create<false, true, mlir::python::populatePassManagerSubmodule(nanobind::module_&)::$_8, void, (anonymous namespace)::PyPassManager&, mlir::python::PyOperationBase&, 0ul, 1ul, nanobind::scope, nanobind::name, nanobind::is_method, nanobind::arg, nanobind::sig, char [81]>(mlir::python::populatePassManagerSubmodule(nanobind::module_&)::$_8&&, void (*)((anonymous namespace)::PyPassManager&, mlir::python::PyOperationBase&), std::__1::integer_sequence<unsigned long, 0ul, 1ul>, nanobind::scope const&, nanobind::name const&, nanobind::is_method const&, nanobind::arg const&, nanobind::sig const&, char const (&) [81])::'lambda'(void*, _object**, unsigned char*, nanobind::rv_policy, nanobind::detail::cleanup_list*)::__invoke(void*, _object**, unsigned char*, nanobind::rv_policy, nanobind::detail::cleanup_list*) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/_mlir.cpython-311-darwin.so+0x2db884)
#42 0x0000000119f2a0cc nanobind::detail::nb_func_vectorcall_complex(_object*, _object* const*, unsigned long, _object*) (/Users/zcarver/Developer/tt-mlir/build/python_packages/ttmlir/_mlir_libs/_mlir.cpython-311-darwin.so+0x2ee0cc)
#43 0x0000000104a24820 _PyEval_EvalFrameDefault (/opt/homebrew/Cellar/python@3.11/3.11.14/Frameworks/Python.framework/Versions/3.11/Python+0x138820)
#44 0x0000000104a1e960 PyEval_EvalCode (/opt/homebrew/Cellar/python@3.11/3.11.14/Frameworks/Python.framework/Versions/3.11/Python+0x132960)
#45 0x0000000104a72858 run_eval_code_obj (/opt/homebrew/Cellar/python@3.11/3.11.14/Frameworks/Python.framework/Versions/3.11/Python+0x186858)
#46 0x0000000104a727bc run_mod (/opt/homebrew/Cellar/python@3.11/3.11.14/Frameworks/Python.framework/Versions/3.11/Python+0x1867bc)
#47 0x0000000104a725fc pyrun_file (/opt/homebrew/Cellar/python@3.11/3.11.14/Frameworks/Python.framework/Versions/3.11/Python+0x1865fc)
#48 0x0000000104a7204c _PyRun_SimpleFileObject (/opt/homebrew/Cellar/python@3.11/3.11.14/Frameworks/Python.framework/Versions/3.11/Python+0x18604c)
#49 0x0000000104a719d8 _PyRun_AnyFileObject (/opt/homebrew/Cellar/python@3.11/3.11.14/Frameworks/Python.framework/Versions/3.11/Python+0x1859d8)
#50 0x0000000104a8e200 pymain_run_file_obj (/opt/homebrew/Cellar/python@3.11/3.11.14/Frameworks/Python.framework/Versions/3.11/Python+0x1a2200)
#51 0x0000000104a8db44 pymain_run_file (/opt/homebrew/Cellar/python@3.11/3.11.14/Frameworks/Python.framework/Versions/3.11/Python+0x1a1b44)
#52 0x0000000104a8d40c Py_RunMain (/opt/homebrew/Cellar/python@3.11/3.11.14/Frameworks/Python.framework/Versions/3.11/Python+0x1a140c)
#53 0x0000000104a8e574 Py_BytesMain (/opt/homebrew/Cellar/python@3.11/3.11.14/Frameworks/Python.framework/Versions/3.11/Python+0x1a2574)
#54 0x000000019ae42b98
